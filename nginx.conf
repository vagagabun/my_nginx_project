# Глобальный контекст
user nginx;               
worker_processes 1;       

# Required events block
events {
    worker_connections 1024;
}

# Контекст http
http {
    include       /etc/nginx/mime.types;   
    default_type  application/octet-stream;

    # Маппинг для проверки user-agent (мобильные устройства)
    map $http_user_agent $is_mobile {
        default         0;
        "~*iphone"      1;
        "~*android"     1;
        "~*blackberry"  1;
        "~*windows phone" 1;
        "~*mobile"      1;
    }

    # Блок server для обработки веб-сервера
    server {
        listen 80;
        server_name localhost;

        # Default root for desktop users
        root /usr/share/nginx/html/desktop;
        index index.html;

        # Serve mobile content for mobile user agents
        location / {
            try_files $uri $uri/ /index.html;
        }

        # Separate location for mobile
        location /mobile {
            alias /usr/share/nginx/html/mobile;
            index index.html;
        }
    }
}
