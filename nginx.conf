# Глобальный контекст
user nginx;               
worker_processes 1;       

# Контекст http
http {
    include       /etc/nginx/mime.types;   
    default_type  application/octet-stream;

    # Маппинг для проверки user-agent (мобильные устройства)
    map $http_user_agent $is_mobile {
        default         0;
        "~*iphone"      1;
        "~*android"     1;
        "~*blackberry"  1;
        "~*windows phone" 1;
        "~*mobile"      1;
    }

    # Блок server для обработки веб-сервера
    server {
        listen 80;
        server_name localhost;

        # Статические файлы по умолчанию (для десктопа)
        root /usr/share/nginx/html/desktop;
        index index.html;

        # Логика для мобильных пользователей
        if ($is_mobile) {
            root /usr/share/nginx/html/mobile;
        }

        # Логика для десктопных пользователей
        if ($is_mobile = 0) {
            root /usr/share/nginx/html/desktop;
        }

        # Основной location блок
        location / {
            try_files $uri $uri/ /index.html;
        }
    }
}
